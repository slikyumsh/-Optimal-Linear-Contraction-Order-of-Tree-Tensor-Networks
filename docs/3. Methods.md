## **3. Обзор методов сокращения тензорных сетей**

Оптимизация порядка сокращений — ключевая задача, от которой зависит эффективность работы с тензорными сетями. Существует несколько классов методов, каждый со своими преимуществами и ограничениями.

---

### **3.1. Жадные эвристики (Greedy Methods)**

**Идея**: на каждом шаге сокращается та пара тензоров, сокращение которой имеет наименьшую локальную стоимость.

**Плюсы**:

* Простота реализации.
* Быстрая работа (линейная по числу сокращений).

**Минусы**:

* Не гарантирует оптимальности.
* Может привести к экспоненциальному росту промежуточных тензоров.

**Примеры**:

* `opt_einsum.greedy`
* `cotengra.greedy`

---

### **3.2. Гиперграфические методы**

**Принцип**: тензорная сеть интерпретируется как **гиперграф**, где вершины — индексы, а гиперрёбра — тензоры. Сокращение соответствует разбиению гиперграфа.

**Инструменты**:

* `KaHyPar` — гиперграфический партиционер.
* Используется в `cotengra.hyper`, `ctg.Hyper-Optimizer`.

**Плюсы**:

* Высокое качество решений.
* Подходит для больших и сложных сетей (например, квантовые цепи).

**Минусы**:

* Более высокая вычислительная сложность.
* Нет гарантии оптимальности.

---

### **3.3. Динамическое программирование (DP)**

**Подход**: перебираются все возможные способы сокращения подцепочек тензоров.

* Для **цепочек (chain)** тензоров:

  * Классическая задача **Matrix Chain Multiplication**.
  * Сложность: $O(n^3)$.

* Реализации:

  * `opt_einsum.dynamic_programming`
  * `cotengra.exact`

**Минусы**:

* Экспоненциальная сложность при произвольной структуре.
* Применимо к маленьким сетям или к цепным топологиям.

---

### **3.4. TensorIKKBZ (изучаемый алгоритм)**

Разработан в 2024 году (Stoian et al.), основан на идеях из оптимизации запросов в базах данных (IKKBZ алгоритм).

**Условия применения**:

* Сеть должна иметь **структуру дерева**.
* Рассматриваются только **линейные порядки сокращений**.

**Ключевые идеи**:

* Стоимость удовлетворяет **свойству ASI** — позволяет принимать локальные решения.
* Используется специальная "оценочная функция" (score function), позволяющая сравнивать порядок сокращения локально.

**Преимущества**:

* **Гарантированно оптимальный** порядок для деревьев.
* **Полиномиальная сложность**: $O(n^2)$.

**Ограничения**:

* Не применим напрямую к общим (недеревообразным) сетям.
* Только линейные сокращения (хотя можно использовать как эвристику в общем случае).

---

### **3.5. LinDP (Linearized Dynamic Programming)**

Это обобщение подхода TensorIKKBZ:

* Сначала используется TensorIKKBZ для построения линейного порядка.
* Затем применяется DP для поиска **лучшего дерева сокращений** в рамках этого порядка.

**Плюсы**:

* Подходит для произвольных сетей.
* Почти оптимален при разумной структуре.

**Минусы**:

* Вычислительно дорогой: $O(n^4)$.
* Возможно дублирование работы.
