## **2. Теоретические основы сокращения тензорных сетей**

### **2.1. Тензоры и тензорные сети**

**Тензор** — это обобщение понятий скаляра (0D), вектора (1D) и матрицы (2D) на произвольное число измерений. Формально, тензор порядка $d$ — это многомерный массив $T \in \mathbb{C}^{n_1 \times n_2 \times \dots \times n_d}$, где $n_i$ — размерность по $i$-й оси.

**Тензорная сеть** — это граф, в котором вершины соответствуют тензорам, а рёбра — общим индексам (называемым "ногами" или "legs") между ними. Такие сети позволяют выразить большие тензоры через композиции меньших, что значительно снижает требования к памяти и вычислениям.

---

### **2.2. Сокращение тензоров**

Сокращение двух тензоров $A$ и $B$ по общим индексам — это обобщение матричного умножения. Пусть $A \in \mathbb{C}^{p_1 \times \dots \times p_a \times q_1 \times \dots \times q_b}$, $B \in \mathbb{C}^{q_1 \times \dots \times q_b \times r_1 \times \dots \times r_c}$. Тогда сокращение по индексам $q_1, \dots, q_b$ определяется как:

$$
(A * B)_{i_1, \dots, i_a, k_1, \dots, k_c} = \sum_{j_1, \dots, j_b} A_{i_1, \dots, i_a, j_1, \dots, j_b} \cdot B_{j_1, \dots, j_b, k_1, \dots, k_c}
$$

Эта операция требует порядка $\prod p_i \cdot \prod q_j \cdot \prod r_k$ скалярных умножений — именно это называется **стоимостью сокращения** двух тензоров.

---

### **2.3. Порядок сокращений**

Полное сокращение тензорной сети сводится к последовательному сокращению пар тензоров, пока не останется один тензор. Хотя результат не зависит от порядка, **суммарная вычислительная стоимость** (число всех операций) может различаться на **несколько порядков величины**.

#### **Виды порядков сокращений**:

* **Линейный порядок**: сокращения происходят вдоль "цепочки" от корня, например: (((A \* B) \* C) \* D).
* **Общий (обобщённый) порядок**: допускаются произвольные поддеревья, например: ((A \* C) \* (B \* D)).

---

### **2.4. Структура сети и сложность задачи**

Задача поиска **оптимального порядка сокращения** является NP-трудной в общем случае. Однако для некоторых классов графов существуют эффективные решения:

* Для **цепочек** — применяется алгоритм умножения цепочки матриц (Matrix Chain Multiplication, $O(n^3)$).
* Для **деревьев** — возможно применение **алгоритма TensorIKKBZ**, который работает за $O(n^2)$ и даёт оптимальный линейный порядок.

---

### **2.5. Стоимость сокращения всей сети**

Пусть сеть содержит $n$ тензоров. Тогда:

* Каждое сокращение — это внутренняя вершина бинарного дерева.
* Общая стоимость определяется как сумма стоимостей всех промежуточных сокращений:

$$
\mathcal{C} = \sum_{i=1}^{n-1} c_i
$$

где $c_i$ — стоимость $i$-го шага.

---

Следующий раздел будет обзором методов: жадных, гиперграфических, DP и TensorIKKBZ. Переходим к нему?
